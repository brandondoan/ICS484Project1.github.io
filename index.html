<!DOCTYPE html>
<html lang="en">

<head>
  <!-- Plotly.js -->
   <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
   <link rel="stylesheet" href="style.css">
</head>
<body>
       <header>
            <button class="button button1"style="float: right" type="button" onclick="alert('Visualization by: Brandon Doan\nData created & compiled by: Robin Wilson\nLibraries used: Plot.ly ')">About this visualization</button> 
           <h2><center><font face="Arial" size="20" color="black">Cholera and UK Census Statistics, 1854</font></center></h2>
           
        </header>
	<div id="thevizcolumn" style="width:100%; height:1000px; background-color:rgb(255, 255, 255);">
		<h2 align="center" style="margin-top:50px;">London Cholera Outbreak of 1854</h2>
      <div style="width:50%; height:800px; float: left; margin: auto;">
      <div id="table1" style="width:100%;height:650px;" ></div>
	  </div>
	  <div style="width:50%; height:650px; float: right; margin-top:110px;">
        <div id="plot1" style="width:100%;height:650px; margin: auto;" ></div>
	</div>
	<div style="width:650px; height:300px; float: left; margin-top: 30px; margin-left: 50px;">
	<hr>
		<p>Statistics shown are for the Broad Street cholera outbreak, that occured in London 1854. The outbreak took its course over the span of mid-August until late September, and eventually led to the deaths of 616 people.</p>
	<hr>
	</div>

	</div>
	
	<div id="thevizcolumn" style="width:100%; height:750px; background-color:rgb(255, 255, 255);">
	<div style="width:80%; height:px;  margin-left: 150px;">
		<div id="mapLondon"></div>

	</div>

	<div style="width:700px; height:250px; float: left; margin-top: 0px; margin-left: 460px;">
	<hr>
	<p align="center">John Snow, a physician at the time, used a dot map similar to the one shown above. With it, he was able to pinpoint the source of the outbreak.</p>
<hr></div>
	</div>


	<div id="thevizcolumn" style="width:100%; height:950px; float: left; ">
		<hr>
		<h2 align="center" style="margin-top:50px;">Cholera statistics for Naples during the same time period</h2>
	<div style="width:50%; height:800px; float: left; margin-top: 110px;">
		<div id="naplesTable" style="width:50%;height:700px;" ></div>
	</div>
	<div style="width:50%; height:800px; float: left; margin: auto;">
		<div id="naplesBar" style="width:100%;height:700px;" ></div>
	</div>
</div>


<div id="thevizcolumn" style="width:100%; height:875px; float: left; ">
	<hr>
	<h2 align="center" style="margin-top:50px;">UK Census Data from 1854 </h2>
<div style="width:50%; height:800px; float: left; margin-top: 110px;">
	<div id="censusTable" style="width:50%;height:700px;" ></div>
</div>
<div style="width:50%; height:800px; float: left; margin: auto;">
	<div id="censusBar" style="width:100%;height:700px;" ></div>
</div>
</div>



<div id="thevizcolumn" style="width:100%; height:800px; float: left; ">
	<div style="width:50%; height:800px; float: left; margin: auto;">
		<div id="censusAgeMalePie" style="width:100%;height:800px;" ></div>
	</div>

	<div style="width:50%; height:800px; float: left; margin:auto;">
		<div id="censusAgeFemalePie" style="width:100%;height:800px;" ></div>
	</div>
	
</div>

<div id="thevizcolumn" style="width:100%; height:750px; background-color:rgb(255, 255, 255);">
<div style="width:30%; height:800px; float: left; margin-left: 400px;">
	<div id="totalPopPie" style="width:100%;height:800px;" ></div>
</div>
</div>

    <script>

        var deaths = [
	{
		"Date": "19-Aug-1854",
		"Attack": 1,
		"Death": 1
	},
	{
		"Date": "20-Aug-1854",
		"Attack": 1,
		"Death": 0
	},
	{
		"Date": "21-Aug-1854",
		"Attack": 1,
		"Death": 2
	},
	{
		"Date": "22-Aug-1854",
		"Attack": 0,
		"Death": 0
	},
	{
		"Date": "23-Aug-1854",
		"Attack": 1,
		"Death": 0
	},
	{
		"Date": "24-Aug-1854",
		"Attack": 1,
		"Death": 2
	},
	{
		"Date": "25-Aug-1854",
		"Attack": 0,
		"Death": 0
	},
	{
		"Date": "26-Aug-1854",
		"Attack": 1,
		"Death": 0
	},
	{
		"Date": "27-Aug-1854",
		"Attack": 1,
		"Death": 1
	},
	{
		"Date": "28-Aug-1854",
		"Attack": 1,
		"Death": 0
	},
	{
		"Date": "29-Aug-1854",
		"Attack": 1,
		"Death": 1
	},
	{
		"Date": "30-Aug-1854",
		"Attack": 8,
		"Death": 2
	},
	{
		"Date": "31-Aug-1854",
		"Attack": 56,
		"Death": 3
	},
	{
		"Date": "1-Sep-1854",
		"Attack": 143,
		"Death": 70
	},
	{
		"Date": "2-Sep-1854",
		"Attack": 116,
		"Death": 127
	},
	{
		"Date": "3-Sep-1854",
		"Attack": 54,
		"Death": 76
	},
	{
		"Date": "4-Sep-1854",
		"Attack": 46,
		"Death": 71
	},
	{
		"Date": "5-Sep-1854",
		"Attack": 36,
		"Death": 45
	},
	{
		"Date": "6-Sep-1854",
		"Attack": 20,
		"Death": 37
	},
	{
		"Date": "7-Sep-1854",
		"Attack": 28,
		"Death": 32
	},
	{
		"Date": "8-Sep-1854",
		"Attack": 12,
		"Death": 30
	},
	{
		"Date": "9-Sep-1854",
		"Attack": 11,
		"Death": 24
	},
	{
		"Date": "10-Sep-1854",
		"Attack": 5,
		"Death": 18
	},
	{
		"Date": "11-Sep-1854",
		"Attack": 5,
		"Death": 15
	},
	{
		"Date": "12-Sep-1854",
		"Attack": 1,
		"Death": 6
	},
	{
		"Date": "13-Sep-1854",
		"Attack": 3,
		"Death": 13
	},
	{
		"Date": "14-Sep-1854",
		"Attack": 0,
		"Death": 6
	},
	{
		"Date": "15-Sep-1854",
		"Attack": 1,
		"Death": 8
	},
	{
		"Date": "16-Sep-1854",
		"Attack": 4,
		"Death": 6
	},
	{
		"Date": "17-Sep-1854",
		"Attack": 2,
		"Death": 5
	},
	{
		"Date": "18-Sep-1854",
		"Attack": 3,
		"Death": 2
	},
	{
		"Date": "19-Sep-1854",
		"Attack": 0,
		"Death": 3
	},
	{
		"Date": "20-Sep-1854",
		"Attack": 0,
		"Death": 0
	},
	{
		"Date": "21-Sep-1854",
		"Attack": 2,
		"Death": 0
	},
	{
		"Date": "22-Sep-1854",
		"Attack": 1,
		"Death": 2
	},
	{
		"Date": "23-Sep-1854",
		"Attack": 1,
		"Death": 3
	},
	{
		"Date": "24-Sep-1854",
		"Attack": 1,
		"Death": 0
	},
	{
		"Date": "25-Sep-1854",
		"Attack": 1,
		"Death": 0
	},
	{
		"Date": "26-Sep-1854",
		"Attack": 1,
		"Death": 2
	},
	{
		"Date": "27-Sep-1854",
		"Attack": 1,
		"Death": 0
	},
	{
		"Date": "28-Sep-1854",
		"Attack": 0,
		"Death": 2
	},
	{
		"Date": "29-Sep-1854",
		"Attack": 0,
		"Death": 1
	}
]
 var naplesData = [
	{
		"age": "0-1",
		"male": 8.2,
		"female": 8.9
	},
	{
		"age": "2-5",
		"male": 14,
		"female": 14.7
	},
	{
		"age": "6-10",
		"male": 12.1,
		"female": 11.2
	},
	{
		"age": "11-15",
		"male": 7.8,
		"female": 7.1
	},
	{
		"age": "16-20",
		"male": 7.2,
		"female": 7.2
	},
	{
		"age": "21-40",
		"male": 12.1,
		"female": 11.8
	},
	{
		"age": "41-60",
		"male": 13.7,
		"female": 12.9
	},
	{
		"age": "61-80",
		"male": 20.5,
		"female": 20.5
	},
	{
		"age": "over 80",
		"male": 39.6,
		"female": 37.8
	}
]

var censusData = [
  {
    "age": "0 to 9",
    "male": 2075391,
    "female": 2065096
  },
  {
    "age": "10 to 19",
    "male": 1711664,
    "female": 1711627
  },
  {
    "age": "20 to 29",
    "male": 1395091,
    "female": 1542876
  },
  {
    "age": "30 to 39",
    "male": 1073914,
    "female": 1140383
  },
  {
    "age": "40 to 49",
    "male": 810979,
    "female": 845260
  },
  {
    "age": "50 to 59",
    "male": 560534,
    "female": 592970
  },
  {
    "age": "60 to 69",
    "male": 351893,
    "female": 399019
  },
  {
    "age": "70 to 79",
    "male": 166194,
    "female": 199326
  },
  {
    "age": "80+",
    "male": 40772,
    "female": 55704
  }
]

var dateOfDeaths = []
var attacks = []
var deathsByDay = []
var deathTotal = [deaths[0].Death]
var attackTotal = [deaths[0].Attack]
var naplesAge = []
var naplesFemale = []
var naplesMale = []
var censusAge = []
var censusFemale = []
var censusMale = []
var totalMales = 0
var totalFemales = 0

var values = [
      dateOfDeaths,
      attacks,
      attackTotal,
      deathsByDay,
      deathTotal]

var data = [{
  type: 'table',
  columnwidth: [60, 20],
  header: {
    values: [["DATE"], ["Attacks that Day"],
				 ["Attacks to Date"], ["Deaths that Day"], ["Deaths to Date"]],
    align: ["center"],
    line: {width: 1, color: '#506784'},
    fill: {color: '#119DFF'},
    font: {family: "Arial", size: 13, color: "white"}
  },
  cells: {
    values: values,
    align: ["center", "right"],
    line: {color: "#506784", width: 1},
	 fill: {color: ['#25FEFD', 'white']},
    font: {family: "Arial", size: 11, color: ["#506784"]}
  }
}]

var naplesValues = [
	naplesAge,
	naplesMale,
	naplesFemale
]

var censusValues = [
	censusAge,
	censusMale,
	censusFemale
]

for (var i = 0; i <naplesData.length; i++) {
    naplesAge.push(naplesData[i].age)
    naplesMale.push(naplesData[i].male)
    naplesFemale.push(naplesData[i].female)
	censusAge.push(censusData[i].age)
    censusMale.push(censusData[i].male)
    censusFemale.push(censusData[i].female)
}




var data2 = [{
  type: 'table',
  header: {
    values: [["Age"], ["Male"],
				 ["Female"]],
    align: ["center"],
    line: {width: 1, color: '#506784'},
    fill: {color: '#119DFF'},
    font: {family: "Arial", size: 13, color: "white"}
  },
  cells: {
    values: naplesValues,
    align: ["left", "right"],
    line: {color: "#506784", width: 1},
	 fill: {color: ['#25FEFD', 'white']},
    font: {family: "Arial", size: 11, color: ["#506784"]}
  }
}]

var data3 = [{
  type: 'table',
  header: {
    values: [["Age"], ["Male"],
				 ["Female"]],
    align: ["center"],
    line: {width: 1, color: '#506784'},
    fill: {color: '#119DFF'},
    font: {family: "Arial", size: 13, color: "white"}
  },
  cells: {
    values: censusValues,
    align: ["left", "right"],
    line: {color: "#506784", width: 1},
	 fill: {color: ['#25FEFD', 'white']},
    font: {family: "Arial", size: 11, color: ["#506784"]}
  }
}]

for (var i = 0; i <deaths.length; i++) {
    dateOfDeaths.push(deaths[i].Date)
    attacks.push(deaths[i].Attack)
    deathsByDay.push(deaths[i].Death)
}

for (var i = 1; i <deaths.length; i++) {
    deathTotal[i] = deathTotal[i-1] + deaths[i].Death
    attackTotal[i] = attackTotal[i-1] + deaths[i].Attack
}

for (var i = 1; i < censusFemale.length; i++) {
    totalFemales = totalFemales + censusFemale[i]
    totalMales = totalMales + censusMale[i]
}
        var trace0 = {
            x: dateOfDeaths,
            y: attacks,
            type: 'scatter',
            name: '# of Attacks',
            line: {
                color: 'rgb(4, 255, 234)',
                width: 3
            }
        };
        var trace1 = {
            x: dateOfDeaths,
            y: deathsByDay,
            type: 'scatter',
            name: '# of Deaths',
            line: {
                color: 'rgb(255, 4, 25)',
                width: 3
             }
        };
        var trace3 = {
            x: dateOfDeaths,
            y: deathTotal,
            type: 'scatter',
            name: 'Cumulative Deaths',
            line: {
                color: 'rgb(255, 4, 255)',
                width: 4
             }
        };
        var trace4 = {
            x: dateOfDeaths,
            y: attackTotal,
            type: 'scatter',
            name: 'Cumulative Attacks',
            line: {
                color: 'rgb(20, 255, 25)',
                width: 4
             }
        };
        data1 = [trace0, trace1, trace3, trace4];



		var trace5 = {
			x: naplesAge,
  			y: naplesMale,
  			name: 'Male',
  			type: 'bar',
			marker: {
    			color: 'rgb(255,96,23)',
    			line: {
      				color: 'rbg(8,48,107)',
      				width: 1.5
    			}
  			}
		};

		var trace6 = {
  			x: naplesAge,
  			y: naplesFemale,
  			name: 'Female',
  			type: 'bar',
			marker: {
    			color: 'rgb(23,182,255)',
    			line: {
      				color: 'rbg(8,48,107)',
      				width: 1.5
    			}
  			}
  
		};

		var trace7 = {
			x: censusAge,
  			y: censusMale,
  			name: 'Male',
  			type: 'bar',
			marker: {
    			color: 'rgb(255,96,23)',
    			line: {
      				color: 'rbg(8,48,107)',
      				width: 1.5
    			}
  			}
		};

		var trace8 = {
  			x: censusAge,
  			y: censusFemale,
  			name: 'Female',
  			type: 'bar',
			marker: {
    			color: 'rgb(23,182,255)',
    			line: {
      				color: 'rbg(8,48,107)',
      				width: 1.5
    			}
  			}
  
		};



		naplesBarData = [trace5, trace6];
		censusBarData= [trace7, trace8];

		var censusAgeMalePieData = [{
  			values: censusMale,
  			labels: censusAge,
  			type: 'pie'
		}];
    
		var censusAgeFemalePieData = [{
  			values: censusFemale,
  			labels: censusAge,
  			type: 'pie'
		}];

		var totalPopPieData = [{
  			values: [totalMales, totalFemales],
  			labels: ['Total Male Population', 'Total Female Population'],
  			type: 'pie'
		}];

       plot1Div = document.getElementById('plot1');
       table1Div = document.getElementById('table1');
	   naplesTableDiv = document.getElementById('naplesTable');
	   censusTableDiv = document.getElementById('censusTable');
	   naplesBarDiv = document.getElementById('naplesBar');
	   censusBarDiv = document.getElementById('censusBar');
	   censusAgeMalePieDiv = document.getElementById('censusAgeMalePie');
	   censusAgeFemalePieDiv = document.getElementById('censusAgeFemalePie');
	   totalPopPieDiv = document.getElementById('totalPopPie');

       var layout = {
           title: "Attacks and deaths over the course of the London Cholera Outbreak of 1854 ",
		   height: 650,
		   width: 830,
           yaxis: {rangemode: 'tozero',
           title: '# of people',
           showline: true,
           zeroline: true},
           xaxis: {
              title: 'Date',
              margin: 160,
              tickangle: 45
          }
       };

       var tablelayout = {
           title: "Amount of cholera attacks and deaths by date.",
		   height: 1000,
		   width: 800,
           yaxis: {rangemode: 'tozero',
          showline: true,
          zeroline: true}
       }

	    var naplesTableLayout = {
           title: "Cholera fatalties in Naples, 1854",
		   height: 700,
		   width: 700,
           yaxis: {rangemode: 'tozero',
          showline: true,
          zeroline: true}
       }

		var censusTableLayout = {
           title: "Population grouped by men and women in different age groups",
           height: 700,
		   width: 700,
		   yaxis: {rangemode: 'tozero',
          showline: true,
          zeroline: true}
       }

	   	var naplesBarLayout ={
			title: "Comparison of gender fatality rates for cholera in Naples, split by age group.",
			xaxis: {title: 'Age (years)'},
  			yaxis: {title: 'Fatalities'},
			height: 700,
		   	width: 700,
			barmode: 'group'
		}

	   	var censusBarLayout ={
			title: "Comparison of gender population in UK split by age group.",
			xaxis: {title: 'Age (years)'},
			yaxis: {title: 'Population (per millions)'},
			barmode: 'group'
		}		
		var censusAgeMaleLayout = {
			title: "Pie chart of the male distrubtion by age group in UK, 1854",
  			height: 700,
			width: 700
		};
		var censusAgeFemaleLayout = {
			title: "Pie chart of the female distrubtion by age group in UK, 1854",
  			height: 700,
			width: 700
		};
		var totalPopLayout = {
			title: "Total populations compared by gender",
  			height: 800,
  			width: 800
		};

		Plotly.d3.tsv("https://raw.githubusercontent.com/brandondoan/ICS484Project1.github.io/master/choleraDeathLocations.tsv", function(err, rows){
			Plotly.d3.tsv("https://raw.githubusercontent.com/brandondoan/ICS484Project1.github.io/master/choleraPumpLocations.tsv", function(err2, rows2){
				function unpack(rows, key) {
		        return rows.map(function(row) { return row[key]; });
		    }
		    var deaths = unpack(rows, "Deaths"),
		        deathsLatitude = unpack(rows, "Latitude"),
		        deathsLongitude = unpack(rows, "Longitude"),
		        deathCount = [],
		        hoverText = [],
						pumpLatitude = unpack(rows2, "Latitude"),
						pumpLongitude = unpack(rows2, "Longitude");
		    for ( var i = 0 ; i < deaths.length; i++) {
		        var currentDeath = deaths[i] * 4; //Multiply to account for size of marker
		        var currentText = "Deaths: " + deaths[i];
		        deathCount.push(currentDeath);
		        hoverText.push(currentText);
		    }
		    var data = [{
		        type: "scattermapbox",
		        lat: deathsLatitude,
		        lon: deathsLongitude,
		        hoverinfo: "text",
		        text: hoverText,
		        marker: {
		            size: deathCount,
								color: "red",
		        },
		    },
				{
						type: "scattermapbox",
						lat: pumpLatitude,
						lon: pumpLongitude,
						hoverinfo: "text",
						text: "Pump",
						marker: {
								size: 15,
								color: "blue",
						},
				}];
				//var data = [deathsData, pumpData];
		    var layout = {
		        title: "Cholera Pump and Death Locations",
						showlegend: false,
						font: {
							family: "Helvetica",
							color: "#000000",
							size: 13
						},
						hoverlabel:{
							font:{
								family: "Helvetica",
								size: 15
							}
						},
						mapbox: {
								style: "dark",
						    bearing:0,
								pitch:0,
						    zoom:16,
						    center: {
						      lat:51.512500,
						      lon:-0.136415
						    },
						},
		    };
				Plotly.setPlotConfig({
				  mapboxAccessToken: 'pk.eyJ1IjoiZXRwaW5hcmQiLCJhIjoiY2luMHIzdHE0MGFxNXVubTRxczZ2YmUxaCJ9.hwWZful0U2CQxit4ItNsiQ'
				})
		    Plotly.newPlot(mapLondon, data, layout, {displayModeBar: false});
			});
		});

        var myChart1=Plotly.plot( plot1Div, data1, layout );
        var myTable1=Plotly.plot( table1Div, data, tablelayout);
		var myNaplesTable=Plotly.plot( naplesTableDiv, data2, naplesTableLayout);
		var myNaplesBar=Plotly.plot( naplesBarDiv, naplesBarData, naplesBarLayout);
		var myCensusTable=Plotly.plot( censusTableDiv, data3, censusTableLayout);
		var myCensusBar=Plotly.plot( censusBarDiv, censusBarData, censusBarLayout);
        var myCensusAgeMalePie=Plotly.plot(censusAgeMalePieDiv, censusAgeMalePieData, censusAgeMaleLayout);
		var myCensusAgeFemalePie=Plotly.plot(censusAgeFemalePieDiv, censusAgeFemalePieData, censusAgeFemaleLayout);
		var mytotalPopPie=Plotly.plot(totalPopPieDiv, totalPopPieData, totalPopLayout);

    </script>
</body>


</html>